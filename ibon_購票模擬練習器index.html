<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ibon è³¼ç¥¨æ¨¡æ“¬ç·´ç¿’å™¨ - 2024 é«˜é›„æ«»èŠ±ç¥­</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        
        :root {
            --ibon-blue: #005bac;
            --ibon-orange: #ff6600;
            --ibon-bg: #f5f5f5;
        }

        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: var(--ibon-bg);
            user-select: none;
        }

        .ibon-screen {
            width: 100vw;
            height: 100vh;
            max-width: 1024px;
            max-height: 768px;
            background: white;
            border: 1px solid #ddd;
            position: relative;
            display: flex;
            flex-direction: column;
            margin: auto;
        }

        .ibon-header {
            background-color: var(--ibon-blue);
            color: white;
            padding: 0.8rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ibon-btn-sm {
            background: var(--ibon-orange);
            color: white;
            padding: 8px 24px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 1rem;
            box-shadow: 0 3px 0 #c44d00;
            transition: all 0.1s;
        }

        .ibon-btn-sm:active {
            transform: translateY(2px);
            box-shadow: 0 1px 0 #c44d00;
        }

        .step-indicator {
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            padding: 0.5rem 1.5rem;
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
            color: #64748b;
        }

        .step-active {
            color: var(--ibon-blue);
            font-weight: bold;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--ibon-orange);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .area-btn {
            transition: all 0.2s;
            border: 1px solid #e2e8f0;
            text-align: left;
            padding: 1.25rem;
            border-radius: 0.5rem;
            background: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .area-btn:hover {
            border-color: var(--ibon-blue);
            background-color: #f0f7ff;
            transform: translateX(4px);
        }

        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .waiting-progress {
            width: 0%;
            height: 100%;
            background-color: var(--ibon-orange);
            transition: width 0.1s linear;
        }

        .event-card {
            border-left: 5px solid var(--ibon-blue);
            transition: transform 0.2s;
        }
        .event-card:hover {
            transform: scale(1.01);
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">

    <div class="ibon-screen shadow-2xl overflow-hidden">
        <!-- é é¦– -->
        <div class="ibon-header">
            <div class="flex items-center gap-2">
                <span class="text-2xl font-black italic">ibon</span>
                <span class="text-lg font-bold border-l pl-3 ml-1">è³¼ç¥¨ç·´ç¿’</span>
            </div>
            <div id="clock" class="text-xl font-mono">12:00:00</div>
        </div>

        <!-- æ­¥é©ŸæŒ‡ç¤ºå™¨ -->
        <div class="step-indicator">
            <span id="step-id-1" class="step-active">1.é¸æ“‡å ´æ¬¡</span>
            <span>></span>
            <span id="step-id-2">2.æ’éšŠç­‰å€™</span>
            <span>></span>
            <span id="step-id-3">3.é¸æ“‡å€åŸŸ</span>
            <span>></span>
            <span id="step-id-4">4.é¸æ“‡å¼µæ•¸/é©—è­‰</span>
            <span>></span>
            <span id="step-id-5">5.å®Œæˆ</span>
        </div>

        <!-- ä¸»å…§å®¹å€ -->
        <div id="main-content" class="flex-1 p-6 relative bg-white overflow-hidden flex flex-col">
            
            <!-- STEP 1: é¸æ“‡å ´æ¬¡ -->
            <div id="step-event" class="overflow-y-auto h-full fade-in">
                <div class="bg-blue-50 p-6 rounded-xl border border-blue-100 mb-6 flex gap-6 items-center">
                    <div class="bg-white p-2 border rounded shadow-sm shrink-0">
                        <div class="w-40 h-24 bg-rose-100 flex items-center justify-center text-rose-400 font-bold text-xs text-center px-2">
                            
                        </div>
                    </div>
                    <div>
                        <h1 class="text-2xl font-black text-blue-900">2024 7-ELEVEN é«˜é›„æ«»èŠ±ç¥­</h1>
                        <p class="text-sm text-blue-600 mt-1">åœ°é»ï¼šé«˜é›„å¤¢æ™‚ä»£æ­£å°é¢æˆ¶å¤–å»£å ´</p>
                    </div>
                </div>

                <div class="space-y-4">
                    <div class="event-card flex items-center justify-between p-5 border border-gray-200 rounded-lg bg-white shadow-sm">
                        <div class="space-y-1">
                            <div class="text-xs font-bold text-gray-400">2024/03/22 (äº”) 16:30</div>
                            <div class="font-black text-xl text-gray-800 tracking-tight">é«˜é›„æ«»èŠ±ç¥­ - é€±äº”å ´æ¬¡</div>
                        </div>
                        <button onclick="enterWaitingRoom()" class="ibon-btn-sm">ç·šä¸Šè¨‚è³¼</button>
                    </div>
                    <div class="event-card flex items-center justify-between p-5 border border-gray-200 rounded-lg bg-white shadow-sm">
                        <div class="space-y-1">
                            <div class="text-xs font-bold text-gray-400">2024/03/23 (å…­) 15:30</div>
                            <div class="font-black text-xl text-gray-800 tracking-tight">é«˜é›„æ«»èŠ±ç¥­ - é€±å…­å ´æ¬¡</div>
                        </div>
                        <button onclick="enterWaitingRoom()" class="ibon-btn-sm">ç·šä¸Šè¨‚è³¼</button>
                    </div>
                </div>
            </div>

            <!-- STEP 2: ç­‰å€™å®¤ -->
            <div id="step-waiting" class="hidden h-full flex flex-col items-center justify-center">
                <div class="spinner mb-6"></div>
                <h2 class="text-2xl font-black text-blue-900 mb-2">ç·šä¸Šç­‰å€™ä¸­</h2>
                <div class="w-80 bg-gray-100 p-6 rounded-lg border border-gray-200 text-center">
                    <div id="wait-timer" class="text-4xl font-black text-orange-500 font-mono mb-4">00:00:03</div>
                    <div class="w-full bg-gray-200 h-2 rounded-full overflow-hidden mb-2">
                        <div id="waiting-bar" class="waiting-progress"></div>
                    </div>
                    <div class="flex justify-between text-[10px] text-gray-400">
                        <span>ID: <span id="wait-id"></span></span>
                        <span id="wait-percent">0%</span>
                    </div>
                </div>
            </div>

            <!-- STEP 3: é¸æ“‡å€åŸŸ -->
            <div id="step-area" class="hidden h-full flex flex-col fade-in">
                <div class="mb-6 flex justify-between items-end">
                    <div>
                        <h2 class="text-2xl font-black text-gray-800">è«‹é¸æ“‡ç¥¨åƒ¹å€åŸŸ</h2>
                        <p class="text-sm text-gray-500">é»é¸æ¬²è³¼ç¥¨ä¹‹å€åŸŸé€²å…¥ä¸‹ä¸€æ­¥</p>
                    </div>
                    <button onclick="showStep('event'); setStepStyle(1);" class="text-blue-600 font-bold text-sm">â® è¿”å›å ´æ¬¡é¸æ“‡</button>
                </div>
                <div id="area-list" class="grid grid-cols-1 gap-3">
                    <!-- å€åŸŸæŒ‰éˆ•åœ¨æ­¤ç”¢ç”Ÿ -->
                </div>
            </div>

            <!-- STEP 4: é¸æ“‡å¼µæ•¸èˆ‡é©—è­‰ -->
            <div id="step-qty" class="hidden h-full flex flex-col fade-in">
                <div class="mb-6">
                    <h2 class="text-2xl font-black text-gray-800">é¸æ“‡å¼µæ•¸èˆ‡é©—è­‰</h2>
                    <p class="text-sm text-gray-500">æ‚¨é¸æ“‡çš„å€åŸŸï¼š<span id="display-area-name" class="font-bold text-blue-600 underline"></span></p>
                </div>

                <div class="bg-gray-50 p-8 rounded-2xl border border-gray-200 flex-1 flex flex-col justify-center max-w-2xl mx-auto w-full space-y-8">
                    <div class="flex justify-around items-center">
                        <div class="text-center">
                            <label class="block text-sm font-bold text-gray-400 mb-3">ç¥¨åˆ¸å¼µæ•¸</label>
                            <div class="flex items-center border-2 border-blue-600 rounded-xl overflow-hidden bg-white shadow-sm">
                                <button onclick="adj(-1)" class="w-14 h-14 bg-blue-50 hover:bg-blue-100 font-bold text-2xl text-blue-600 transition-colors">-</button>
                                <span id="q-val" class="w-20 text-center text-3xl font-black text-gray-800">1</span>
                                <button onclick="adj(1)" class="w-14 h-14 bg-blue-50 hover:bg-blue-100 font-bold text-2xl text-blue-600 transition-colors">+</button>
                            </div>
                        </div>

                        <div class="text-center">
                            <label class="block text-sm font-bold text-gray-400 mb-3">åœ–å½¢é©—è­‰ç¢¼</label>
                            <div class="flex flex-col gap-2">
                                <div id="cap-box" class="bg-blue-900 text-white px-6 py-2 flex items-center justify-center font-black italic text-2xl rounded-lg tracking-[0.5em] select-none shadow-inner"></div>
                                <input type="text" id="cap-in" class="w-full border-2 border-gray-300 h-12 text-center font-bold uppercase rounded-lg outline-none focus:border-blue-600 transition-all" placeholder="è«‹è¼¸å…¥é©—è­‰ç¢¼">
                            </div>
                        </div>
                    </div>

                    <div class="pt-6 border-t flex gap-4">
                        <button onclick="toAreaSelect(false)" class="flex-1 bg-gray-200 text-gray-600 py-4 font-bold rounded-xl hover:bg-gray-300">â® è¿”å›é¸å€</button>
                        <button onclick="submitTicket()" class="flex-[2] bg-orange-500 text-white py-4 font-black text-xl rounded-xl shadow-lg hover:bg-orange-600 active:scale-[0.98] transition-all">ç¢ºèªè³¼ç¥¨é€å‡º</button>
                    </div>
                </div>
            </div>

            <!-- STEP 5: æˆåŠŸ -->
            <div id="step-finish" class="hidden h-full flex flex-col items-center justify-center fade-in">
                <div class="bg-green-50 p-10 rounded-2xl border border-green-200 text-center shadow-md max-w-md">
                    <div class="text-6xl mb-4">ğŸ‰</div>
                    <h2 class="text-3xl font-black text-green-700 mb-4">è³¼ç¥¨æˆåŠŸï¼</h2>
                    <div class="bg-white p-4 rounded-lg border border-green-100 text-left mb-8">
                        <p id="final-stat" class="text-gray-700 leading-relaxed whitespace-pre-line font-medium"></p>
                    </div>
                    <button onclick="location.reload()" class="bg-blue-600 text-white px-12 py-3 rounded-full font-bold shadow-lg hover:bg-blue-700">è¿”å›é¦–é </button>
                </div>
            </div>

        </div>
    </div>

    <!-- æç¤ºæ¡† -->
    <div id="alert-box" class="hidden fixed inset-0 bg-black/60 z-[99] flex items-center justify-center p-4">
        <div class="bg-white p-8 rounded-2xl max-w-xs w-full text-center shadow-2xl">
            <p id="alert-msg" class="font-bold text-gray-800 mb-6"></p>
            <button onclick="closeAlert()" class="bg-blue-600 text-white w-full py-3 rounded-xl font-bold">æˆ‘çŸ¥é“äº†</button>
        </div>
    </div>

    <script>
        let timerStart, selectedArea, qty = 1, currentCap = "";

        const areas = [
            { name: "æ–æ»¾ç«™å€ A (åºè™Ÿå…¥å ´)", price: 1199 },
            { name: "æ–æ»¾ç«™å€ B (åºè™Ÿå…¥å ´)", price: 1199 },
            { name: "ä¸€èˆ¬å€ (è‡ªç”±å…¥å ´)", price: 899 },
            { name: "æ„›å¿ƒç¥¨", price: 450 }
        ];

        function enterWaitingRoom() {
            setStepStyle(2);
            showStep('waiting');
            document.getElementById('wait-id').innerText = Math.random().toString(36).substr(2, 8).toUpperCase();
            let remaining = 3;
            const bar = document.getElementById('waiting-bar');
            const timer = document.getElementById('wait-timer');
            
            const itv = setInterval(() => {
                remaining--;
                bar.style.width = ((3-remaining)/3)*100 + '%';
                timer.innerText = `00:00:0${remaining}`;
                if(remaining <= 0) {
                    clearInterval(itv);
                    toAreaSelect(true);
                }
            }, 1000);
        }

        function toAreaSelect(isFirstTime) {
            if(isFirstTime) timerStart = Date.now();
            setStepStyle(3);
            showStep('area');
            const list = document.getElementById('area-list');
            list.innerHTML = "";
            areas.forEach(a => {
                const b = document.createElement('button');
                b.className = "area-btn";
                b.innerHTML = `<span class="font-black text-gray-800">${a.name}</span><span class="text-blue-600 font-black text-lg">$${a.price}</span>`;
                b.onclick = () => {
                    toQtySelect(a.name);
                };
                list.appendChild(b);
            });
        }

        function toQtySelect(name) {
            selectedArea = name;
            document.getElementById('display-area-name').innerText = name;
            setStepStyle(4);
            showStep('qty');
            genCap();
            document.getElementById('cap-in').value = "";
        }

        function adj(v) { 
            qty = Math.max(1, Math.min(4, qty + v)); 
            document.getElementById('q-val').innerText = qty; 
        }

        function genCap() {
            currentCap = Math.random().toString(36).substr(2, 4).toUpperCase();
            document.getElementById('cap-box').innerText = currentCap;
        }

        function submitTicket() {
            const input = document.getElementById('cap-in').value.trim().toUpperCase();
            if(!input) return showAlert("è«‹è¼¸å…¥é©—è­‰ç¢¼");
            if(input !== currentCap) {
                showAlert("é©—è­‰ç¢¼éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥");
                genCap();
                document.getElementById('cap-in').value = "";
                return;
            }
            const speed = ((Date.now() - timerStart)/1000).toFixed(2);
            setStepStyle(5);
            showStep('finish');
            document.getElementById('final-stat').innerText = `â± å®Œæˆé€Ÿåº¦ï¼š${speed} ç§’\nğŸ“ è³¼è²·å€åŸŸï¼š${selectedArea}\nğŸ« ç¥¨åˆ¸å¼µæ•¸ï¼š${qty} å¼µ`;
        }

        function showStep(s) {
            document.querySelectorAll('#main-content > div').forEach(d => d.classList.add('hidden'));
            document.getElementById('step-' + s).classList.remove('hidden');
        }

        function setStepStyle(num) {
            document.querySelectorAll('.step-indicator span').forEach(s => s.classList.remove('step-active'));
            document.getElementById('step-id-' + num).classList.add('step-active');
        }

        function showAlert(m) { document.getElementById('alert-msg').innerText = m; document.getElementById('alert-box').classList.remove('hidden'); }
        function closeAlert() { document.getElementById('alert-box').classList.add('hidden'); }

        setInterval(() => {
            document.getElementById('clock').innerText = new Date().toTimeString().split(' ')[0];
        }, 1000);
    </script>
</body>
</html>